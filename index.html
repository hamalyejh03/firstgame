<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Survie des √âtoiles</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: black;
        font-family: Arial, sans-serif;
        color: white;
        text-align: center;
    }

    canvas {
        display: block;
    }

    #gameOverScreen {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(88, 13, 13, 0.9);
        display: none;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }

   button {
    padding: 15px 30px;
    font-size: 18px;
    cursor: pointer;
    border: 6px solid red; /* bordure rouge */
    border-radius: 10px;
    background: white;
    color: black;
    margin-top: 20px;
    transition: background 0.2s, color 0.2s; /* transition douce */

     box-shadow: 0 0 10px red, 0 0 20px red;
}

button:active {
    background: red;  /* fond rouge quand appuy√© */
    color: white;     /* texte blanc quand appuy√© */
    box-shadow: 0 0 20px red, 0 0 30px red;
}
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<div id="gameOverScreen">
    <h1>Game Over</h1>
    <h2 id="finalScore"></h2>
    <button onclick="restartGame()">Try Again</button>
</div>

<script>
let playerImg = new Image();
playerImg.src = "player.png";

let starImg = new Image();
starImg.src = "star.png";

let bombImg = new Image();
bombImg.src = "bomb.png";

let bgImg = new Image();
bgImg.src = "background.jpg";

const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}

resizeCanvas();
window.addEventListener("resize", resizeCanvas);

let player = {
    x: canvas.width / 2 - 25,
    y: canvas.height - 60,
    width: 50,
    height: 50
};

let stars = [];
let bombs = [];

let score = 0;
let starSpeed = 3;
let bombSpeed = 4;
let level = 1;
let gameRunning = true;

// =====================
// ‚≠ê Cr√©ation √©toiles et bombes selon le niveau
// =====================
function createStar() {
    if(gameRunning){
        for(let i=0;i<level;i++){
            let x = Math.random() * (canvas.width - 20);
            stars.push({ x: x, y: -20, width: 20, height: 20 });
        }
    }
}

function createBomb() {
    if(gameRunning){
        for(let i=0;i<level;i++){
            let x = Math.random() * (canvas.width - 20);
            bombs.push({ x: x, y: -20, width: 20, height: 20 });
        }
    }
}

function goFullScreen() {
    if (canvas.requestFullscreen) {
        canvas.requestFullscreen();
    } else if (canvas.webkitRequestFullscreen) { 
        canvas.webkitRequestFullscreen();
    } else if (canvas.msRequestFullscreen) { 
        canvas.msRequestFullscreen();
    }
}

canvas.addEventListener("click", goFullScreen);

// =====================
// üî• Mettre √† jour la difficult√©
// =====================
function updateDifficulty(){
    if(score < 10){
        starSpeed = 3;
        bombSpeed = 4;
        level = 1;
    }
    else if(score < 25){
        starSpeed = 5;
        bombSpeed = 6;
        level = 2;
    }
    else if(score < 40){
        starSpeed = 7;
        bombSpeed = 8;
        level = 3;
    }
    else if(score < 70){
        starSpeed = 9;
        bombSpeed = 10;
        level = 4;
    }
    else{
        starSpeed = 11;
        bombSpeed = 12;
        level = 5;
    }
}

// =====================
// ‚ú® Dessiner √©toiles
// =====================
function drawStars(){
    for(let i=0;i<stars.length;i++){
        let star = stars[i];
        ctx.drawImage(starImg, star.x, star.y, star.width, star.height);
        star.y += starSpeed;

        if(
            star.x < player.x + player.width &&
            star.x + star.width > player.x &&
            star.y < player.y + player.height &&
            star.y + star.height > player.y
        ){
            score++;
            stars.splice(i,1);
            i--;
            updateDifficulty();
        } else if(star.y > canvas.height){
            stars.splice(i,1);
            i--;
        }
    }
}

// =====================
// üí£ Dessiner bombes
// =====================
function drawBombs(){
    for(let i=0;i<bombs.length;i++){
        let bomb = bombs[i];
        ctx.drawImage(bombImg, bomb.x, bomb.y, bomb.width, bomb.height);
        bomb.y += bombSpeed;

        if(
            bomb.x < player.x + player.width &&
            bomb.x + bomb.width > player.x &&
            bomb.y < player.y + player.height &&
            bomb.y + bomb.height > player.y
        ){
            endGame();
        } else if(bomb.y > canvas.height){
            bombs.splice(i,1);
            i--;
        }
    }
}

// =====================
// üë§ Dessiner joueur
// =====================
function drawPlayer(){
    ctx.drawImage(playerImg, player.x, player.y, player.width, player.height);
}

// =====================
// üìù Dessiner score
// =====================
function drawScore(){
    ctx.fillStyle = "white";
    ctx.font = "24px Arial";
    ctx.fillText("Score: " + score, 20, 40);
}

// =====================
// üîÑ Boucle principale
// =====================
function gameLoop(){
    if(!gameRunning) return;

    ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);

    drawPlayer();
    drawStars();
    drawBombs();
    drawScore();

    requestAnimationFrame(gameLoop);
}

// =====================
// üíÄ Game Over
// =====================
function endGame(){
    gameRunning = false;
    document.getElementById("finalScore").innerText = "Your score is " + score;
    document.getElementById("gameOverScreen").style.display = "flex";
}

// =====================
// üîÑ Restart
// =====================
function restartGame(){
    stars = [];
    bombs = [];
    score = 0;
    starSpeed = 3;
    bombSpeed = 4;
    level = 1;
    gameRunning = true;
    document.getElementById("gameOverScreen").style.display = "none";
    gameLoop();
}

// =====================
// üéØ D√©placement du joueur
// =====================
canvas.addEventListener("mousemove", function(e){
    player.x = e.clientX - player.width / 2;
    if(player.x < 0) player.x = 0;
    if(player.x + player.width > canvas.width)
        player.x = canvas.width - player.width;
});

// D√©placement tactile
canvas.addEventListener("touchmove", function(e){
    e.preventDefault(); // emp√™cher le scroll
    let touch = e.touches[0];
    player.x = touch.clientX - player.width / 2;
    if(player.x < 0) player.x = 0;
    if(player.x + player.width > canvas.width)
        player.x = canvas.width - player.width;
}, {passive:false});

// =====================
// ‚è± Intervalles
// =====================
setInterval(createStar,1200);
setInterval(createBomb,3000);

gameLoop();

</script>

</body>

</html>
